<!DOCTYPE html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="module" src="https://pyscript.net/releases/2025.8.1/core.js"></script>
<!-- HTMLの本体 --- (*1) -->
<body>
    <h1>サイコロの目がフェードインします</h1>
    <div><button py-click="start">サイコロをふる</button><div>
    <div id="disp"></div>
</body>
<!-- CSSの定義 --- (*2) -->
<style>
body { text-align:center; }
#disp { font-size:8em; color:red; }
#image_area { padding-top: 100px; }
@keyframes fade-in {
    from { opacity: 0; } /* 透明 */
    to   { opacity: 1; } /* 不透明 */
}
</style>
<script type="py">
    import random
    from pyscript import document
    from js import setTimeout, window
    from pyodide.ffi import create_proxy

    disp = document.getElementById("disp")
    
    # ボタンをクリックされたときに呼び出される関数
    def start(event):
        disp.innerHTML = str(random.randint(1, 6))
        # サイコロのアニメーションを開始
        disp.style.animation = "fade-in 2s"
        # 2秒後にstop関数を呼び出す
        setTimeout(create_proxy(stop), 2000)

    # アニメを止める関数
    def stop():
        # id属性がdispのものを取得 --- (*11)
        disp = document.getElementById("disp")
        disp.style.animation = "none"
        window.console.log("stopped")
</script>
